<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fund NAV Chart</title>
  <!-- Load Highcharts -->
  <script src="https://code.highcharts.com/stock/highstock.js"></script>
</head>
<body>
  <!-- Container for the chart -->
  <div id="navChartContainer" style="width: 100%; height: 400px;"></div>

  <!-- JavaScript to fetch CSV data and create the chart -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const csvUrl = 'https://raw.githubusercontent.com/mcleancapital/website/main/Diamond_Chart.csv';

      fetch(csvUrl)
        .then(response => response.text())
        .then(data => {
          const parsedData = parseCSV(data);

          Highcharts.stockChart('navChartContainer', {
            rangeSelector: { selected: 1 },
            title: { text: 'Fund NAV Historical Performance' },
            series: [{
              name: 'NAV',
              data: parsedData,
              tooltip: { valueDecimals: 2 }
            }],
            tooltip: { split: true },
            navigator: { enabled: true },
            scrollbar: { enabled: true }
          });
        })
        .catch(error => console.error('Error fetching data:', error));

      function parseCSV(data) {
        const rows = data.split('\n').slice(1); // Remove header row
        return rows.map(row => {
          const [dateStr, value] = row.split(',');
          const date = new Date(dateStr.trim());
          const numericValue = parseFloat(value.trim());

          if (!isNaN(numericValue)) {
            return [Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()), numericValue];
          }
        }).filter(Boolean);
      }
    });
  </script>
</body>
</html>
