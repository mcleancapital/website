document.addEventListener('DOMContentLoaded', function () {
  // URL to fetch data from Google Sheets as CSV
  const csvUrl = 'https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=csv';

  // Fetch data from Google Sheets
  fetch(csvUrl)
    .then(response => response.text())
    .then(data => {
      // Parse the CSV data
      const parsedData = parseCSV(data);

      // Set up the chart using parsed data
      Highcharts.stockChart('navChartContainer', {
        rangeSelector: { selected: 1 },
        title: { text: 'Fund NAV Historical Performance' },
        series: [{
          name: 'NAV',
          data: parsedData,
          tooltip: { valueDecimals: 2 }
        }],
        tooltip: { split: true },
        navigator: { enabled: true },
        scrollbar: { enabled: true }
      });
    })
    .catch(error => console.error('Error fetching data:', error));

  // Function to parse CSV data into Highcharts format
  function parseCSV(data) {
    const rows = data.split('\n').slice(1); // Remove header row
    return rows.map(row => {
      const [dateStr, value] = row.split(',');
      const date = new Date(dateStr);
      return [Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()), parseFloat(value)];
    });
  }
});
